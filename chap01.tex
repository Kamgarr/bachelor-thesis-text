\chapter{Overview of techniques}
This chapter will introduce the techniques used to simulate the destructible environment. First, it will talk about the development of the destructible environment in a few games and game engines and then about general approaches to this problem. In this chapter, we will use word object as a reference to buildings, crates, doors and other items, excluding terrain, skyboxes and characters.

\section{Game engine approaches}
\begin{itemize}
\item \textbf{Object replacement or removal} was the first method used to simulate the destructible environment in a computer game mostly because it is straightforward and undemanding. Despite its simplicity, it can still produce a very desirable result. In fact, it is still most widely used approach to the destructible environment in computer games.

The first 2D games featuring destructible environment are arcade games like the \emph{Space Invaders (1978)}~\footnote{https://en.wikipedia.org/wiki/Space\_Invaders} where the environment is represented by cells in a grid. After taking damage, the texture of the cell is replaced by another one and the finally completely removed. The next environment destruction technique in 2D games came with games like \emph{Scorched Earth (1991)}~\footnote{https://en.wikipedia.org/wiki/Scorched\_Earth\_(video\_game)} and \emph{Worms (1995)}~\footnote{https://www.team17.com/games/worms-original}. Collision and removal of terrain in those games is based on individual pixels which create a more realistic visual effect.

The most common implementation of destructible objects in 3D games has not changed much over the years. Every object that the player can modify has a set of more damaged models prepared. Based on how much damage is applied, the models are swapped and eventually completely removed~\ref{doors}. It is usually accompanied by animations, debris and dust generation to make the process look realistic. The downfall of this method is the necessity to replace the whole in-game object. There has to be a significant number of objects pre-made for different scenarios to make the game look realistic and it has little flexibility to react to specific player actions. As an example, in the \emph{Source} engine, the hole in the doors~\ref{doors} is always in the same place without considering the point of impact.


\begin{figure}[ht!]
\centering
%\includegraphics[width=\textwidth]{img/doors}
\caption{\emph{Source} engine swapping door models}
\label{doors}
\end{figure}

\item \textbf{\emph{Geo-Mod}} \cite{geomod} or \emph{Geometry Modification Technology} is an engine developed for the \emph{Red Faction (2001)}~\footnote{http://redfaction.wikia.com/wiki/Red\_Faction} video game. It allows players to modify and make holes in the terrain using the solution of creating objects representing an empty space. The difference of meshes is calculated in real time to represent the terrain with a hole. Even though the engine does not work well with the buildings and other objects, it represents one of the first significant attempts to create the fully destructible 3D environment in real time constraints.

\item \textbf{\emph{Geo-Mod 2}}~\cite{geomod}\footnote{Geo-Mod 2.0 presentation video https://www.youtube.com/watch?v=lICurOVsNv0} does not feature destructible terrain, instead, it uses physics simulation on specially prepared objects. A set of smaller objects is used as a ragdoll for the stress-based simulation model. The complexity of simulation limits the engine in the scale of the game world and mutual proximity of destructible objects.


\item \textbf{\emph{Frostbite}}~\footnote{http://www.frostbite.com/about/frostbite-3} engine and mainly it's component \emph{Destruction}~\cite{destruction} is currently used in the most titles featuring destructible environment. It supports the dynamic micro-destruction on the surface and the large scale predetermined destruction on whole buildings. For the large-scale destruction, the buildings are created from smaller parts linked together. Each part can disappear on its own, and when there is not enough left, the whole building collapses. It does not use internal body stress or any physics while doing this simulation. \emph{Frostbite} is a proprietary engine and there is no public information on the implementation of micro-destruction.

\end{itemize}

\section{Soft body deformation}

\begin{itemize}

\item \textbf{Finite Element Method} (FEM) is a means to simulate the behaviour of complex objects and systems.  It uses a large number of finite volumes(cells), interconnected or not, to simulate the reaction of material to inner and outside forces. Each cell calculates its physics states like stress or temperature and propagates the results to neighbouring cells. This model allows for simulation of fluid dynamics, brittle fractures~\cite{brittlefracture}, ductility~\cite{ductilefracture}, elasticity, heat transfer and other physical properties. It is beneficial in engineering, modelling and rendering scenes for computer generated images but FEM requires a lot of computational resources and therefore until recently it was not possible to implement it in real-time environment of a computer game. Now with better hardware and optimised algorithms especially developed for real-time animation, like the one O'Brien~\cite{femingames} describes this method is making its way into modern games.

\item \textbf{Material Point method} (MPM) is used to simulate the behaviour of continuum materials. MPM is a meshfree and Arbitrary Lagrangianâ€“Eulerian numerical method \cite{ALE}. The Lagrangian element, or a material point, is the primary representation possessing position, velocity and deformation gradient. Here is the simplified overview of algorithm step, for more details see Jiangs thesis~\cite{jiang2015material} 
\begin{enumerate}
    \item Grid data are reinitialized to default values.
    \item Weights and weight gradients are computed on every particle.
    \item Mass and momentum are transferred from the particles to the grid.
    \item The explicit forces on nodes are computed
    \item The explicit nodal velocity update is performed
    \item Grid based collision is performed on vertices.
    \item Particles are updated from grid velocities.
\end{enumerate}
MPM is useful for both fluid and soft body dynamics. It can simulate deformation, fractures, heat transfer, melting and other changes of material properties.

\begin{figure}[h!]
\centering
\includegraphics[width=\textwidth]{img/MPM}
\caption{MPM algorithm overview. The top and the bottom rows operate in particle domain(Lagrangian) while the middle depicts grid-based (Eulerian) operations. \cite{disney}
}
\label{mpm}
\end{figure}

\section{Rigid body decomposition}

\item \textbf{Voronoi tessellation} is a method of decomposing an object into a smaller parts. It can also be used for terrain generation, but we will focus on object decomposition. There are other solutions for decomposition, for example slicing by planes or convex decomposition. Voronoi cells are considered to look better and more natural than other methods. The tessellation can be done in following three steps, assuming the input is a closed triangular mesh with non-empty volume.
\begin{enumerate}
    \item Delaunay tetrahedral decomposition \\ given points P in general position (the vertices of input mesh and a set of points inside its volume), tetrahedral mesh DT(P) can be generated satisfying the following condition: no point in P is inside the circumscribed sphere of any tetrahedra in DT(P).
    \item Creating Voronoi diagram \\ for Delaunay tetrahedral decomposition, its dual graph (with vertices in the centre of tetrahedrons circumscribed sphere) is Voronoi diagram
    \begin{figure}[ht!]
        \centering
        %\includegraphics[width=0.4\textwidth]{img/delaunay}
        %\includegraphics[width=0.4\textwidth]{img/voronoi}
        \caption{Transformation of 2D Delaunay triangulation to Voronoi diagram. Source: https://en.wikipedia.org/wiki/Delaunay\_triangulation}
        \label{DT}
    \end{figure}0
    \item Clipping Voronoi diagram \\ boundary cells of the Voronoi diagram are infinite (see the figure above~\ref{DT}) and they need to be clipped by the original input triangular mesh. The efficient algorithm~\cite{yan2010efficient} for this task finds the intersection of the boundary Voronoi cell with the triangular mesh and continues with neighbourhood propagation to determine all intersections. 
\end{enumerate}

\begin{figure}[ht!]
        \centering
        \includegraphics[width=0.4\textwidth]{img/clipped}
        \caption{The result of Voronoi tessellation \cite{yan2010efficient}}
        \label{voro}
\end{figure}
\end{itemize}

